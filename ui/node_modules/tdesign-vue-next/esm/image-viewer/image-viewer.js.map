{"version":3,"file":"image-viewer.js","sources":["../../src/image-viewer/image-viewer.tsx"],"sourcesContent":["import { computed, defineComponent, ref, toRefs, Teleport, watch, Transition, nextTick } from 'vue';\nimport { ChevronLeftIcon, ChevronDownIcon, CloseIcon } from 'tdesign-icons-vue-next';\n\nimport props from './props';\nimport TImageViewerIcon from './base/ImageModalIcon';\nimport TImageViewerUtils from './base/ImageViewerUtils';\nimport TImageItem from './base/ImageItem';\nimport TImageViewerModal from './base/ImageViewerModal';\nimport { useTNodeJSX } from '../hooks/tnode';\nimport useVModel from '../hooks/useVModel';\nimport useDefaultValue from '../hooks/useDefaultValue';\nimport { usePrefixClass } from '../hooks/useConfig';\nimport { TdImageViewerProps } from './type';\nimport { useMirror, useRotate, useScale } from './hooks';\nimport { formatImages, getOverlay } from './utils';\nimport { EVENT_CODE } from './const';\nimport Image from '../image';\nimport usePopupManager from '../hooks/usePopupManager';\n\nexport default defineComponent({\n  name: 'TImageViewer',\n  props: { ...props },\n  setup(props) {\n    const classPrefix = usePrefixClass();\n    const COMPONENT_NAME = usePrefixClass('image-viewer');\n    const renderTNodeJSX = useTNodeJSX();\n    const isExpand = ref(true);\n    const showOverlayValue = computed(() => getOverlay(props));\n\n    const { index, visible, modelValue } = toRefs(props);\n    const [indexValue, setIndexValue] = useDefaultValue(index, props.defaultIndex ?? 0, props.onIndexChange, 'index');\n    const [visibleValue, setVisibleValue] = useVModel(visible, modelValue, props.defaultVisible, () => {}, 'visible');\n    const animationEnd = ref(true);\n    const animationTimer = ref();\n\n    const wrapClass = computed(() => [\n      COMPONENT_NAME.value,\n      `${COMPONENT_NAME.value}-preview-image`,\n      {\n        [`${classPrefix.value}-is-hide`]: !visibleValue.value,\n      },\n    ]);\n    const headerClass = computed(() => [\n      `${classPrefix.value}-image-viewer__modal-header`,\n      {\n        [`${classPrefix.value}-is-show`]: isExpand.value,\n      },\n    ]);\n    const zIndexValue = computed(() => props.zIndex ?? 2600);\n    const toggleExpand = () => {\n      isExpand.value = !isExpand.value;\n    };\n\n    const { mirror, onMirror, resetMirror } = useMirror();\n    const { scale, onZoomIn, onZoomOut, resetScale } = useScale(props.imageScale);\n    const { rotate, onRotate, resetRotate } = useRotate();\n    const onRest = () => {\n      resetMirror();\n      resetScale();\n      resetRotate();\n    };\n\n    const images = computed(() => formatImages(props.images));\n    const currentImage = computed(() => images.value[indexValue.value] ?? { mainImage: '' });\n\n    const { isLastDialog } = usePopupManager('dialog', {\n      visible: visibleValue,\n    });\n\n    const prevImage = () => {\n      const newIndex = indexValue.value - 1;\n      onRest();\n      setIndexValue(newIndex < 0 ? 0 : newIndex, { trigger: 'prev' });\n    };\n\n    const nextImage = () => {\n      const newIndex = indexValue.value + 1;\n      onRest();\n      setIndexValue(newIndex >= images.value.length ? indexValue.value : newIndex, { trigger: 'next' });\n    };\n\n    const onImgClick = (i: number) => {\n      setIndexValue(i, { trigger: 'current' });\n    };\n\n    const openHandler = () => {\n      setVisibleValue(true);\n    };\n    const onClose: TdImageViewerProps['onClose'] = (ctx) => {\n      setVisibleValue(false);\n      props.onClose?.(ctx);\n    };\n    const closeBtnAction = (e: MouseEvent) => {\n      onClose({ e, trigger: 'close-btn' });\n    };\n    const clickOverlayHandler = (e: MouseEvent) => {\n      if (props.closeOnOverlay) {\n        onClose({ e, trigger: 'overlay' });\n      }\n    };\n\n    const keydownHandler = (e: KeyboardEvent) => {\n      e.stopPropagation();\n\n      switch (e.code) {\n        case EVENT_CODE.left:\n          prevImage();\n          break;\n        case EVENT_CODE.right:\n          nextImage();\n          break;\n        case EVENT_CODE.up:\n          onZoomIn();\n          break;\n        case EVENT_CODE.down:\n          onZoomOut();\n          break;\n        case EVENT_CODE.esc:\n          if (props.closeOnEscKeydown && isLastDialog()) {\n            onClose({ e, trigger: 'esc' });\n          }\n          break;\n        default:\n          break;\n      }\n    };\n\n    const divRef = ref<HTMLDivElement>();\n    watch(\n      () => visibleValue.value,\n      (val) => {\n        clearTimeout(animationTimer.value);\n        if (val) {\n          animationEnd.value = false;\n          nextTick().then(() => {\n            divRef.value?.focus?.();\n          });\n\n          onRest();\n        } else {\n          animationTimer.value = setTimeout(() => {\n            animationEnd.value = true;\n          }, 200);\n        }\n      },\n    );\n\n    const onWheel = (e: WheelEvent) => {\n      e.preventDefault();\n      const { deltaY } = e;\n\n      deltaY > 0 ? onZoomOut() : onZoomIn();\n    };\n\n    const transStyle = computed(() => ({\n      transform: `translateX(calc(-${indexValue.value} * (40px / 9 * 16 + 4px)))`,\n    }));\n\n    const renderHeader = () => (\n      <div class={headerClass.value}>\n        <TImageViewerIcon\n          icon={() => <ChevronDownIcon />}\n          class={`${COMPONENT_NAME.value}__header-pre-bt`}\n          onClick={toggleExpand}\n        />\n        <div class={`${COMPONENT_NAME.value}__header-prev`}>\n          <div class={`${COMPONENT_NAME.value}__header-trans`} style={transStyle.value}>\n            {images.value.map((image, index) => (\n              <div\n                key={index}\n                class={[\n                  `${COMPONENT_NAME.value}__header-box`,\n                  {\n                    [`${classPrefix.value}-is-active`]: index === indexValue.value,\n                  },\n                ]}\n              >\n                <Image\n                  src={image.thumbnail || image.mainImage}\n                  error=\"\"\n                  className={`${COMPONENT_NAME.value}__header-img`}\n                  onClick={() => onImgClick(index)}\n                />\n              </div>\n            ))}\n          </div>\n        </div>\n      </div>\n    );\n    const renderNavigationArrow = (type: 'prev' | 'next') => {\n      const rotateDeg = type === 'prev' ? 0 : 180;\n      const icon = renderTNodeJSX(\n        'navigationArrow',\n        <ChevronLeftIcon style={{ transform: `rotate(${rotateDeg}deg)` }} size=\"24px\" />,\n      );\n\n      return (\n        <TImageViewerIcon\n          class={`${COMPONENT_NAME.value}__modal-${type}-bt`}\n          onClick={type === 'prev' ? prevImage : nextImage}\n          icon={() => icon}\n        />\n      );\n    };\n\n    const renderCloseBtn = () => {\n      if (props.closeBtn === false) {\n        return;\n      }\n      return (\n        <div\n          class={[`${COMPONENT_NAME.value}__modal-icon`, `${COMPONENT_NAME.value}__modal-close-bt`]}\n          onClick={closeBtnAction}\n        >\n          {renderTNodeJSX('closeBtn', <CloseIcon size=\"24px\" />)}\n        </div>\n      );\n    };\n\n    return () => {\n      if (props.mode === 'modeless') {\n        return (\n          <>\n            {renderTNodeJSX('trigger', { params: { open: openHandler } })}\n            <TImageViewerModal\n              zIndex={zIndexValue.value}\n              visible={visibleValue.value}\n              index={indexValue.value}\n              images={images.value}\n              scale={scale.value}\n              rotate={rotate.value}\n              mirror={mirror.value}\n              currentImage={currentImage.value}\n              onRotate={onRotate}\n              onZoomIn={onZoomIn}\n              onZoomOut={onZoomOut}\n              onMirror={onMirror}\n              onReset={onRest}\n              onClose={onClose}\n              draggable={props.draggable}\n              showOverlay={showOverlayValue.value}\n              title={props.title}\n            />\n          </>\n        );\n      }\n\n      return (\n        <>\n          {renderTNodeJSX('trigger', { params: { open: openHandler } })}\n          <Teleport to=\"body\">\n            <Transition>\n              {(visibleValue.value || !animationEnd.value) && (\n                <div\n                  ref={divRef}\n                  v-show={visibleValue.value}\n                  class={wrapClass.value}\n                  style={{ zIndex: zIndexValue.value }}\n                  onWheel={onWheel}\n                  tabindex={-1}\n                  onKeydown={keydownHandler}\n                >\n                  {!!showOverlayValue.value && (\n                    <div class={`${COMPONENT_NAME.value}__modal-mask`} onClick={clickOverlayHandler} />\n                  )}\n                  {images.value.length > 1 && (\n                    <>\n                      {renderHeader()}\n                      <div class={`${COMPONENT_NAME.value}__modal-index`}>\n                        {props.title && renderTNodeJSX('title')}\n                        {`${indexValue.value + 1}/${images.value.length}`}\n                      </div>\n                      {renderNavigationArrow('prev')}\n                      {renderNavigationArrow('next')}\n                    </>\n                  )}\n                  {renderCloseBtn()}\n                  <TImageViewerUtils\n                    onZoomIn={onZoomIn}\n                    onZoomOut={onZoomOut}\n                    onMirror={onMirror}\n                    onReset={onRest}\n                    onRotate={onRotate}\n                    scale={scale.value}\n                    currentImage={currentImage.value}\n                  />\n                  <TImageItem\n                    scale={scale.value}\n                    rotate={rotate.value}\n                    mirror={mirror.value}\n                    src={currentImage.value.mainImage}\n                    placementSrc={currentImage.value.thumbnail}\n                  />\n                </div>\n              )}\n            </Transition>\n          </Teleport>\n        </>\n      );\n    };\n  },\n});\n"],"names":["defineComponent","name","props","_objectSpread","setup","_props2$defaultIndex","classPrefix","usePrefixClass","COMPONENT_NAME","renderTNodeJSX","useTNodeJSX","isExpand","ref","showOverlayValue","computed","getOverlay","_toRefs","toRefs","index","visible","modelValue","_useDefaultValue","useDefaultValue","defaultIndex","onIndexChange","_useDefaultValue2","_slicedToArray","indexValue","setIndexValue","_useVModel","useVModel","defaultVisible","_useVModel2","visibleValue","setVisibleValue","animationEnd","animationTimer","wrapClass","value","concat","_defineProperty","headerClass","zIndexValue","_props2$zIndex","zIndex","toggleExpand","_useMirror","useMirror","mirror","onMirror","resetMirror","_useScale","useScale","imageScale","scale","onZoomIn","onZoomOut","resetScale","_useRotate","useRotate","rotate","onRotate","resetRotate","onRest","images","formatImages","currentImage","_images$value$indexVa","mainImage","_usePopupManager","usePopupManager","isLastDialog","prevImage","newIndex","trigger","nextImage","length","onImgClick","i","openHandler","onClose","ctx","_props2$onClose","closeBtnAction","e","clickOverlayHandler","closeOnOverlay","keydownHandler","stopPropagation","code","EVENT_CODE","left","right","up","down","esc","closeOnEscKeydown","divRef","watch","val","clearTimeout","nextTick","then","_divRef$value","_divRef$value$focus","focus","call","setTimeout","onWheel","preventDefault","deltaY","transStyle","transform","renderHeader","_createVNode","TImageViewerIcon","icon","ChevronDownIcon","map","image","Image","thumbnail","onClick","renderNavigationArrow","type","rotateDeg","ChevronLeftIcon","renderCloseBtn","closeBtn","CloseIcon","mode","_Fragment","params","open","TImageViewerModal","draggable","title","Teleport","_default","Transition","_withDirectives","TImageViewerUtils","TImageItem","_vShow"],"mappings":"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"}