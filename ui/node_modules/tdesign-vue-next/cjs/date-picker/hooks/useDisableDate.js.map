{"version":3,"file":"useDisableDate.js","sources":["../../../src/date-picker/hooks/useDisableDate.ts"],"sourcesContent":["import dayjs from 'dayjs';\nimport isArray from 'lodash/isArray';\nimport isFunction from 'lodash/isFunction';\nimport isObject from 'lodash/isObject';\n\nimport type { TdDatePickerProps, TdDateRangePickerProps } from '../type';\n\nexport interface disableDateProps {\n  disableDate?: TdDatePickerProps['disableDate'] | TdDateRangePickerProps['disableDate'];\n  format?: TdDatePickerProps['format'];\n  mode?: TdDatePickerProps['mode'];\n  start?: Date;\n  end?: Date;\n}\n\nexport default function useDisableDate(props: disableDateProps) {\n  return {\n    disableDate: (value: Date) =>\n      !isEnabled({ disableDate: props.disableDate, format: props.format, mode: props.mode, value }),\n    minDate:\n      isObject(props.disableDate) && 'before' in props.disableDate ? new Date(props.disableDate.before) : props.start,\n    maxDate:\n      isObject(props.disableDate) && 'after' in props.disableDate ? new Date(props.disableDate.after) : props.end,\n  };\n}\n\nfunction isEnabled(props: any): boolean {\n  if (!props.disableDate) return true;\n\n  let isEnabled = true;\n  // 值类型为 Function 则表示返回值为 true 的日期会被禁用\n  if (isFunction(props.disableDate)) {\n    return !props.disableDate(props.value);\n  }\n\n  // 禁用日期，示例：['A', 'B'] 表示日期 A 和日期 B 会被禁用。\n  if (isArray(props.disableDate)) {\n    let isIncludes = false;\n    const formatedDisabledDate = props.disableDate.map((item: string) => dayjs(item, props.format));\n    formatedDisabledDate.forEach((item: any) => {\n      if (item.isSame(dayjs(props.value))) {\n        isIncludes = true;\n      }\n    });\n    return !isIncludes;\n  }\n\n  // { from: 'A', to: 'B' } 表示在 A 到 B 之间的日期会被禁用。\n  if (props.disableDate.from && props.disableDate.to) {\n    const compareMin = dayjs(new Date(props.disableDate.from));\n    const compareMax = dayjs(new Date(props.disableDate.to));\n\n    return !dayjs(props.value).isBetween(compareMin, compareMax, props.mode, '[]');\n  }\n\n  const min = props.disableDate.before ? new Date(props.disableDate.before) : null;\n  const max = props.disableDate.after ? new Date(props.disableDate.after) : null;\n\n  // { before: 'A', after: 'B' } 表示在 A 之前和在 B 之后的日期都会被禁用。\n  if (max && min) {\n    const compareMin = dayjs(new Date(min));\n    const compareMax = dayjs(new Date(max));\n\n    isEnabled = dayjs(props.value).isBetween(compareMin, compareMax, props.mode, '[]');\n  } else if (min) {\n    const compareMin = dayjs(new Date(min));\n    isEnabled = !dayjs(props.value).isBefore(compareMin, props.mode);\n  } else if (max) {\n    const compareMax = dayjs(new Date(max));\n    isEnabled = !dayjs(props.value).isAfter(compareMax, props.mode);\n  }\n  return isEnabled;\n}\n"],"names":["useDisableDate","props","disableDate","value","isEnabled","format","mode","minDate","isObject","Date","before","start","maxDate","after","end","isFunction","isArray","isIncludes","formatedDisabledDate","map","item","dayjs","forEach","isSame","from","to","compareMin","compareMax","isBetween","min","max","isBefore","isAfter"],"mappings":"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"}