{"version":3,"file":"slider.js","sources":["../../../src/color-picker/panel/slider.tsx"],"sourcesContent":["import { computed, defineComponent, onBeforeUnmount, onMounted, PropType, reactive, ref } from 'vue';\nimport { SLIDER_DEFAULT_WIDTH } from '../const';\nimport { Draggable, Coordinate } from '../utils';\nimport { useBaseClassName } from '../hooks';\nimport baseProps from './base-props';\n\nexport default defineComponent({\n  name: 'ColorSlider',\n  props: {\n    ...baseProps,\n    className: {\n      type: String,\n      default: '',\n    },\n    value: {\n      type: Number,\n      default: 0,\n    },\n    maxValue: {\n      type: Number,\n      default: 360,\n    },\n    railStyle: {\n      type: Object as PropType<any>,\n    },\n    type: {\n      type: String as PropType<'hue' | 'alpha'>,\n      default: 'hue',\n    },\n  },\n  setup(props) {\n    const baseClassName = useBaseClassName();\n    const refPanel = ref<HTMLElement>(null);\n    const refThumb = ref<HTMLElement>(null);\n    const dragInstance = ref<Draggable>(null);\n    const panelRect = reactive({\n      width: SLIDER_DEFAULT_WIDTH,\n    });\n    const styles = computed(() => {\n      const { width } = panelRect;\n      if (!width) {\n        return;\n      }\n      const left = Math.round((props.value / props.maxValue) * width);\n      return {\n        left: `${left}px`,\n        color: props.color.rgb,\n      };\n    });\n\n    const handleDrag = (coordinate: Coordinate, isEnded?: boolean) => {\n      if (props.disabled) {\n        return;\n      }\n      const { width } = panelRect;\n      const { x } = coordinate;\n      const value = Math.round((x / width) * props.maxValue * 100) / 100;\n      props.onChange(value, isEnded);\n    };\n\n    const handleDragEnd = (coordinate: Coordinate) => {\n      if (props.disabled) {\n        return;\n      }\n      handleDrag(coordinate, true);\n    };\n\n    onMounted(() => {\n      panelRect.width = refPanel.value.offsetWidth || SLIDER_DEFAULT_WIDTH;\n      dragInstance.value = new Draggable(refPanel.value, {\n        start: () => {\n          // pop模式下由于是隐藏显示，这个宽度让其每次点击的时候重新计算\n          panelRect.width = refPanel.value.offsetWidth;\n        },\n        drag: (coordinate: Coordinate) => {\n          handleDrag(coordinate);\n        },\n        end: handleDragEnd,\n      });\n    });\n\n    onBeforeUnmount(() => {\n      dragInstance.value.destroy();\n    });\n\n    return {\n      baseClassName,\n      refThumb,\n      refPanel,\n      styles,\n    };\n  },\n  render() {\n    const { baseClassName, className, railStyle, styles, type, color } = this;\n    const paddingStyle = {\n      background: `linear-gradient(90deg, rgba(0,0,0,.0) 0%, rgba(0,0,0,.0) 93%, ${color.rgb} 93%, ${color.rgb} 100%)`,\n    };\n    return (\n      <div class={[`${baseClassName}__slider-wrapper`, `${baseClassName}__slider-wrapper--${type}-type`]}>\n        {type === 'alpha' && <div className={`${baseClassName}__slider-padding`} style={paddingStyle} />}\n        <div class={[`${baseClassName}__slider`, className]} ref=\"refPanel\">\n          <div class={`${baseClassName}__rail`} style={railStyle}></div>\n          <span class={[`${baseClassName}__thumb`]} role=\"slider\" tabindex={0} ref=\"refThumb\" style={styles}></span>\n        </div>\n      </div>\n    );\n  },\n});\n"],"names":["defineComponent","name","props","_objectSpread","baseProps","className","type","String","value","Number","maxValue","railStyle","Object","setup","baseClassName","useBaseClassName","refPanel","ref","refThumb","dragInstance","panelRect","reactive","width","SLIDER_DEFAULT_WIDTH","styles","computed","left","Math","round","color","rgb","handleDrag","coordinate","isEnded","disabled","x","onChange","handleDragEnd","onMounted","offsetWidth","Draggable","start","drag","end","onBeforeUnmount","destroy","render","paddingStyle","background","concat","_createVNode"],"mappings":"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"}