{"version":3,"file":"skeleton.js","sources":["../../src/skeleton/skeleton.tsx"],"sourcesContent":["import { h, defineComponent, ref, watch } from 'vue';\nimport isNumber from 'lodash/isNumber';\nimport isFunction from 'lodash/isFunction';\nimport props from './props';\nimport { SkeletonRowCol, SkeletonRowColObj, TdSkeletonProps } from './type';\nimport { usePrefixClass } from '../hooks/useConfig';\nimport { useContent } from '../hooks/tnode';\nimport isArray from 'lodash/isArray';\n\nconst ThemeMap: Record<TdSkeletonProps['theme'], SkeletonRowCol> = {\n  text: [1],\n  avatar: [{ type: 'circle', size: '56px' }],\n  paragraph: [1, 1, { width: '70%' }],\n  'avatar-text': [[{ type: 'circle' }, { type: 'text', height: '32px' }]],\n  tab: [{ height: '30px' }, { height: '200px' }],\n  article: [\n    { type: 'rect', height: '30px', width: '100%' },\n    { type: 'rect', height: '200px', width: '100%' },\n    [\n      { type: 'text', height: '30px' },\n      { type: 'text', height: '30px' },\n      { type: 'text', height: '30px' },\n    ],\n    [\n      { type: 'text', height: '30px' },\n      { type: 'text', height: '30px' },\n    ],\n    [\n      { type: 'text', height: '30px' },\n      { type: 'text', height: '30px' },\n    ],\n    [\n      { type: 'text', height: '30px' },\n      { type: 'text', height: '30px' },\n    ],\n  ],\n};\n\nconst getColItemStyle = (obj: SkeletonRowColObj) => {\n  const styleName = ['width', 'height', 'marginRight', 'marginLeft', 'margin', 'size', 'background', 'backgroundColor'];\n  const style = Object.create(null);\n  styleName.forEach((name) => {\n    if (name in obj) {\n      const px = isNumber(obj[name]) ? `${obj[name]}px` : obj[name];\n      if (name === 'size') {\n        [style.width, style.height] = [px, px];\n      } else {\n        style[name] = px;\n      }\n    }\n  });\n  return style;\n};\n\nexport default defineComponent({\n  name: 'TSkeleton',\n\n  props: { ...props },\n\n  setup(props, { slots }) {\n    const isShow = ref(false);\n    const COMPONENT_NAME = usePrefixClass('skeleton');\n    const renderContent = useContent();\n    const getColItemClass = (obj: SkeletonRowColObj) => [\n      `${COMPONENT_NAME.value}__col`,\n      `${COMPONENT_NAME.value}--type-${obj.type || 'text'}`,\n      { [`${COMPONENT_NAME.value}--animation-${props.animation}`]: props.animation },\n    ];\n\n    const renderCols = (_cols: Number | SkeletonRowColObj | Array<SkeletonRowColObj>) => {\n      let cols: Array<SkeletonRowColObj> = [];\n      if (isArray(_cols)) {\n        cols = _cols;\n      } else if (isNumber(_cols)) {\n        cols = new Array(_cols).fill({ type: 'text' });\n      } else {\n        cols = [_cols as SkeletonRowColObj];\n      }\n      return cols.map((obj) => (\n        <div class={getColItemClass(obj)} style={getColItemStyle(obj)}>\n          {isFunction(obj.content) ? obj.content(h) : obj.content}\n        </div>\n      ));\n    };\n\n    const renderRowCol = (_rowCol?: SkeletonRowCol) => {\n      const rowCol: SkeletonRowCol = _rowCol || props.rowCol;\n\n      const getBlockClass = () => [`${COMPONENT_NAME.value}__row`];\n\n      return rowCol.map((item) => <div class={getBlockClass()}>{renderCols(item)}</div>);\n    };\n\n    let timer: NodeJS.Timeout = null;\n\n    watch(\n      () => props.loading,\n      (bool) => {\n        if (!bool) {\n          clearTimeout(timer);\n          isShow.value = false;\n          return;\n        }\n        if (props.delay > 0) {\n          timer = setTimeout(() => {\n            clearTimeout(timer);\n            isShow.value = true;\n          }, props.delay);\n        } else {\n          isShow.value = true;\n        }\n      },\n      { immediate: true },\n    );\n\n    return () => {\n      const content = renderContent('default', 'content');\n\n      if (slots.default && !isShow.value) {\n        return <div>{content}</div>;\n      }\n\n      if (!isShow.value) {\n        return;\n      }\n\n      const children = [];\n      if (props.theme) {\n        children.push(renderRowCol(ThemeMap[props.theme]));\n      }\n      if (props.rowCol) {\n        children.push(renderRowCol(props.rowCol));\n      }\n      if (!props.theme && !props.rowCol) {\n        // 什么都不传时，传入默认 rowCol\n        children.push(renderRowCol([1, 1, 1, { width: '70%' }]));\n      }\n\n      return <div class={COMPONENT_NAME.value}>{children}</div>;\n    };\n  },\n});\n"],"names":["ThemeMap","text","avatar","type","size","paragraph","width","height","tab","article","getColItemStyle","obj","styleName","style","Object","create","forEach","name","px","isNumber","_ref","defineComponent","props","_objectSpread","setup","slots","_ref2","isShow","ref","COMPONENT_NAME","usePrefixClass","renderContent","useContent","getColItemClass","concat","value","_defineProperty","animation","renderCols","_cols","cols","isArray","Array","fill","map","_createVNode","isFunction","content","h","renderRowCol","_rowCol","rowCol","getBlockClass","item","timer","watch","loading","bool","clearTimeout","delay","setTimeout","immediate","children","theme","push"],"mappings":"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"}