{"version":3,"file":"menu-item.js","sources":["../../src/menu/menu-item.tsx"],"sourcesContent":["import { defineComponent, computed, inject, onMounted, ref, toRefs, getCurrentInstance } from 'vue';\nimport props from './menu-item-props';\nimport { TdMenuInterface, TdSubMenuInterface } from './const';\nimport { renderContent, renderTNodeJSX } from '../utils/render-tnode';\nimport { emitEvent } from '../utils/event';\nimport useRipple from '../hooks/useRipple';\nimport { usePrefixClass } from '../hooks/useConfig';\nimport Tooltip from '../tooltip';\n\nexport default defineComponent({\n  name: 'TMenuItem',\n  props: { ...props },\n  emits: ['click'],\n  setup(props, ctx) {\n    const { href, target } = toRefs(props);\n    const classPrefix = usePrefixClass();\n    const menu = inject<TdMenuInterface>('TdMenu');\n    const itemRef = ref<HTMLElement>();\n    useRipple(itemRef);\n    const submenu = inject<TdSubMenuInterface>('TdSubmenu', null);\n    const active = computed(() => menu.activeValue.value === props.value);\n    const collapsed = computed(() => menu.collapsed?.value);\n    const classes = computed(() => [\n      `${classPrefix.value}-menu__item`,\n      {\n        [`${classPrefix.value}-is-active`]: active.value,\n        [`${classPrefix.value}-is-disabled`]: props.disabled,\n        [`${classPrefix.value}-menu__item--plain`]: !ctx.slots.icon && !props.icon,\n        [`${classPrefix.value}-submenu__item`]: !!submenu && !menu.isHead,\n      },\n    ]);\n    // lifetimes\n    onMounted(() => {\n      menu?.vMenu?.add({ value: props.value, parent: submenu?.value, vnode: ctx.slots.default, ...props });\n    });\n\n    return {\n      classPrefix,\n      menu,\n      active,\n      collapsed,\n      classes,\n      itemRef,\n      href,\n      target,\n      submenu,\n    };\n  },\n  methods: {\n    handleClick(e: MouseEvent) {\n      e.stopPropagation();\n      if (this.disabled) return;\n      this.menu.select(this.value);\n      emitEvent(this, 'click', { e, value: this.value });\n      if (this.to || (this.routerLink && this.href)) {\n        const router = this.router || this.$router;\n        const methods: string = this.replace ? 'replace' : 'push';\n        router[methods](this.to || this.href).catch((err: Error) => {\n          // vue-router 3.1.0+ push/replace cause NavigationDuplicated error\n          // https://github.com/vuejs/vue-router/issues/2872\n          // 当前path和目标path相同时，会抛出NavigationDuplicated的错误\n          if (\n            err.name !== 'NavigationDuplicated' &&\n            !err.message.includes('Avoided redundant navigation to current location')\n          ) {\n            throw err;\n          }\n        });\n      }\n      this.submenu?.closeParentPopup?.(e);\n    },\n  },\n  render() {\n    const router = this.router || this.$router;\n\n    const liContent = (\n      <li ref=\"itemRef\" class={this.classes} onClick={this.handleClick}>\n        {renderTNodeJSX(this, 'icon')}\n        {this.routerLink ? (\n          <a\n            href={this.href ? this.href : this.to ? router?.resolve(this.to).href : ''}\n            target={this.target}\n            class={`${this.classPrefix}-menu__item-link`}\n            onClick={(e) => e.preventDefault()}\n          >\n            <span class={`${this.classPrefix}-menu__content`}>{renderContent(this, 'default', 'content')}</span>\n          </a>\n        ) : this.href ? (\n          <a\n            href={this.href}\n            target={this.target}\n            class={`${this.classPrefix}-menu__item-link`}\n            onClick={(e) => this.disabled && e.preventDefault()}\n          >\n            <span class={`${this.classPrefix}-menu__content`}>{renderContent(this, 'default', 'content')}</span>\n          </a>\n        ) : (\n          <span class={`${this.classPrefix}-menu__content`}>{renderContent(this, 'default', 'content')}</span>\n        )}\n      </li>\n    );\n\n    const instance = getCurrentInstance();\n    const node = instance.parent;\n    // 菜单收起，且只有本身为一级菜单才需要显示 tooltip\n    if (this.collapsed && /tmenu/i.test(node?.type.name)) {\n      return (\n        <Tooltip content={() => renderContent(this, 'default', 'content')} placement=\"right\">\n          {liContent}\n        </Tooltip>\n      );\n    }\n    return liContent;\n  },\n});\n"],"names":["_isSlot","s","Object","prototype","toString","call","_isVNode","defineComponent","name","props","_objectSpread","emits","setup","ctx","_toRefs","toRefs","href","target","classPrefix","usePrefixClass","menu","inject","itemRef","ref","useRipple","submenu","active","computed","activeValue","value","collapsed","_menu$collapsed","classes","concat","_defineProperty","disabled","slots","icon","isHead","onMounted","_menu$vMenu","vMenu","add","parent","vnode","methods","handleClick","e","_this$submenu","_this$submenu$closePa","stopPropagation","select","emitEvent","to","routerLink","router","$router","replace","err","message","includes","closeParentPopup","render","_this","liContent","_createVNode","renderTNodeJSX","resolve","onClick","preventDefault","renderContent","instance","getCurrentInstance","node","test","type","Tooltip","content","_default"],"mappings":"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"}