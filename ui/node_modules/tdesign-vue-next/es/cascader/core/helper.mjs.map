{"version":3,"file":"helper.mjs","sources":["../../../src/cascader/core/helper.ts"],"sourcesContent":["import isNumber from 'lodash/isNumber';\nimport isObject from 'lodash/isObject';\nimport isArray from 'lodash/isArray';\nimport isEmpty from 'lodash/isEmpty';\nimport {\n  TreeNode,\n  CascaderContextType,\n  TdCascaderProps,\n  CascaderValue,\n  TreeNodeValue,\n  TreeOptionData,\n} from '../interface';\n\n/**\n * 单选状态下内容\n * @param isHover\n * @param cascaderContext\n * @returns\n */\nexport function getSingleContent(cascaderContext: CascaderContextType): string {\n  const { value, multiple, treeStore, showAllLevels } = cascaderContext;\n  if (multiple || (value !== 0 && !value)) return '';\n\n  if (isArray(value)) return '';\n  const node = treeStore && treeStore.getNodes(value as TreeNodeValue | TreeNode);\n  if (!(node && node.length)) {\n    return value as string;\n  }\n  const path = node && node[0].getPath();\n  if (path && path.length) {\n    return showAllLevels ? path.map((node: TreeNode) => node.label).join(' / ') : path[path.length - 1].label;\n  }\n  return value as string;\n}\n\n/**\n * 多选状态下选中内容\n * @param cascaderContext\n * @returns\n */\nexport function getMultipleContent(cascaderContext: CascaderContextType) {\n  const { value, multiple, treeStore, showAllLevels } = cascaderContext;\n\n  if (!multiple) return [];\n  if (multiple && !isArray(value)) return [];\n\n  const node = treeStore && treeStore.getNodes(value as TreeNodeValue | TreeNode);\n  if (!node) return [];\n\n  return (value as TreeNodeValue[])\n    .map((item: TreeNodeValue) => {\n      const node = treeStore.getNodes(item);\n      return showAllLevels ? getFullPathLabel(node[0]) : node[0]?.label;\n    })\n    .filter((item) => !!item);\n}\n\n/**\n * 面板数据计算方法\n * @param treeNodes\n * @returns\n */\nexport function getPanels(treeNodes: CascaderContextType['treeNodes']) {\n  const panels: TreeNode[][] = [];\n  treeNodes.forEach((node: TreeNode) => {\n    if (panels[node.level]) {\n      panels[node.level].push(node);\n    } else {\n      panels[node.level] = [node];\n    }\n  });\n  return panels;\n}\n\n/**\n * 获取node的全部路径\n * @param node\n * @returns\n */\nexport function getFullPathLabel(node: TreeNode, separator = '/') {\n  return node\n    ?.getPath()\n    .map((node: TreeNode) => node.label)\n    .join(separator);\n}\n\n/**\n * treeValue计算方法\n * @param value\n * @returns\n */\nexport const getTreeValue = (value: CascaderContextType['value']) => {\n  let treeValue: TreeNodeValue[] = [];\n  if (isArray(value)) {\n    if (value.length > 0 && isObject(value[0])) {\n      treeValue = (value as TreeOptionData[]).map((val) => val.value);\n    } else if (value.length) {\n      treeValue = value as TreeNodeValue[];\n    }\n  } else if (!isEmptyValues(value)) {\n    if (isObject(value)) {\n      treeValue = [(value as TreeOptionData).value];\n    } else {\n      treeValue = [value];\n    }\n  }\n  return treeValue;\n};\n\n/**\n * 按数据类型计算通用数值\n * @param value\n * @param showAllLevels\n * @param multiple\n * @returns\n */\nexport const getCascaderValue = (value: CascaderValue, valueType: TdCascaderProps['valueType'], multiple: boolean) => {\n  if (valueType === 'single') {\n    return value;\n  }\n  if (multiple) {\n    return (value as Array<CascaderValue>).map((item: TreeNodeValue[]) => item[item.length - 1]);\n  }\n  return value[(value as Array<CascaderValue>).length - 1];\n};\n\n/**\n * 空值校验\n * 补充value为Number时的空值校验逻辑，排除NaN\n * @param value\n * @returns\n */\nexport function isEmptyValues(value: unknown): boolean {\n  if (isNumber(value) && !isNaN(value)) return false;\n  return isEmpty(value);\n}\n\n/**\n * 初始化数据校验\n * @param value\n * @param cascaderContext\n * @returns boolean\n */\nexport function isValueInvalid(value: CascaderValue, cascaderContext: CascaderContextType) {\n  const { multiple, showAllLevels } = cascaderContext;\n  return (multiple && !isArray(value)) || (!multiple && isArray(value) && !showAllLevels);\n}\n"],"names":["getSingleContent","cascaderContext","value","multiple","treeStore","showAllLevels","isArray","node","getNodes","length","path","getPath","map","label","join","getMultipleContent","item","_node2$","getFullPathLabel","filter","getPanels","treeNodes","panels","forEach","level","push","separator","arguments","undefined","getTreeValue","treeValue","isObject","val","isEmptyValues","getCascaderValue","valueType","isNumber","isNaN","isEmpty","isValueInvalid"],"mappings":"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"}