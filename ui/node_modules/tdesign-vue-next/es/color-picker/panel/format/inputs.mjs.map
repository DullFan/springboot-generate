{"version":3,"file":"inputs.mjs","sources":["../../../../src/color-picker/panel/format/inputs.tsx"],"sourcesContent":["import { computed, defineComponent, PropType, reactive, watch } from 'vue';\nimport throttle from 'lodash/throttle';\nimport props from '../../props';\nimport { Color } from '../../utils';\nimport TInput from '../../../input';\nimport TInputNumber from '../../../input-number';\nimport { FORMAT_INPUT_CONFIG } from './config';\n\nexport default defineComponent({\n  name: 'FormatInputs',\n  inheritAttrs: false,\n  props: {\n    ...props,\n    color: {\n      type: Object as PropType<Color>,\n    },\n    onInputChange: {\n      type: Function,\n      default: () => {\n        return () => {};\n      },\n    },\n  },\n  setup(props) {\n    const inputConfigs = computed(() => {\n      const configs = [...FORMAT_INPUT_CONFIG[props.format]];\n      if (props.enableAlpha) {\n        configs.push({\n          type: 'inputNumber',\n          key: 'a',\n          min: 0,\n          max: 100,\n          format: (value: number) => `${value}%`,\n          flex: 1.15,\n        });\n      }\n      return configs;\n    });\n\n    const modelValue = reactive<any>({});\n    const lastModelValue = reactive<any>({});\n\n    /**\n     * 获取不同格式的输入输出值\n     * @param type 'encode' | 'decode'\n     * @returns\n     */\n    const getFormatColorMap = (type: 'encode' | 'decode') => {\n      const { color } = props;\n      if (type === 'encode') {\n        return {\n          HSV: color.getHsva(),\n          HSL: color.getHsla(),\n          RGB: color.getRgba(),\n          CMYK: color.getCmyk(),\n          CSS: {\n            css: color.css,\n          },\n          HEX: {\n            hex: color.hex,\n          },\n        };\n      }\n      // decode\n      return {\n        HSV: Color.object2color(modelValue, 'HSV'),\n        HSL: Color.object2color(modelValue, 'HSL'),\n        RGB: Color.object2color(modelValue, 'RGB'),\n        CMYK: Color.object2color(modelValue, 'CMYK'),\n        CSS: modelValue.css,\n        HEX: modelValue.hex,\n      };\n    };\n\n    // 更新modelValue\n    const updateModelValue = () => {\n      const { format, color } = props;\n      const values: any = getFormatColorMap('encode')[format];\n      values.a = Math.round(color.alpha * 100);\n      Object.keys(values).forEach((key) => {\n        modelValue[key] = values[key];\n        lastModelValue[key] = values[key];\n      });\n    };\n\n    updateModelValue();\n\n    const throttleUpdate = throttle(updateModelValue, 100);\n\n    watch(() => {\n      const { saturation, hue, value, alpha, css } = props.color;\n      return [saturation, hue, value, alpha, css, props.format];\n    }, throttleUpdate);\n\n    const handleChange = (key: string, v: number | string) => {\n      if (v === lastModelValue[key]) {\n        return;\n      }\n      const value = getFormatColorMap('decode')[props.format];\n      props.onInputChange(value, modelValue.a / 100, key, v);\n    };\n\n    return {\n      modelValue,\n      inputConfigs,\n      handleChange,\n    };\n  },\n  render() {\n    const inputProps = {\n      ...((this.inputProps as any) || {}),\n    };\n    return (\n      <div class=\"input-group\">\n        {this.inputConfigs.map((config) => {\n          return (\n            <div\n              class=\"input-group__item\"\n              key={config.key}\n              style={{\n                flex: config.flex || 1,\n              }}\n            >\n              {config.type === 'input' ? (\n                <TInput\n                  {...inputProps}\n                  align=\"center\"\n                  size=\"small\"\n                  disabled={this.disabled}\n                  v-model={this.modelValue[config.key]}\n                  maxlength={this.format === 'HEX' ? 9 : undefined}\n                  title={this.modelValue[config.key]}\n                  onBlur={(v: string) => this.handleChange(config.key, v)}\n                  onEnter={(v: string) => this.handleChange(config.key, v)}\n                />\n              ) : (\n                <TInputNumber\n                  {...inputProps}\n                  align=\"center\"\n                  size=\"small\"\n                  disabled={this.disabled}\n                  v-model={this.modelValue[config.key]}\n                  title={this.modelValue[config.key]}\n                  min={config.min}\n                  max={config.max}\n                  step={1}\n                  format={config.format}\n                  theme=\"normal\"\n                  onBlur={(v: number) => this.handleChange(config.key, v)}\n                  onEnter={(v: number) => this.handleChange(config.key, v)}\n                />\n              )}\n            </div>\n          );\n        })}\n      </div>\n    );\n  },\n});\n"],"names":["defineComponent","name","inheritAttrs","props","_objectSpread","color","type","Object","onInputChange","Function","_default","setup","inputConfigs","computed","configs","_toConsumableArray","FORMAT_INPUT_CONFIG","format","enableAlpha","push","key","min","max","value","concat","flex","modelValue","reactive","lastModelValue","getFormatColorMap","HSV","getHsva","HSL","getHsla","RGB","getRgba","CMYK","getCmyk","CSS","css","HEX","hex","Color","object2color","updateModelValue","values","a","Math","round","alpha","keys","forEach","throttleUpdate","throttle","watch","_props2$color","saturation","hue","handleChange","v","render","_this","inputProps","_createVNode","map","config","TInput","_mergeProps","disabled","onUpdateModelValue","$event","onBlur","onEnter","TInputNumber"],"mappings":"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"}