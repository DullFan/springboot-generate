{"version":3,"file":"useInputWidth.mjs","sources":["../../src/input/useInputWidth.ts"],"sourcesContent":["import useResizeObserver from '../hooks/useResizeObserver';\nimport { onMounted, Ref, ref, watch, nextTick, onBeforeUnmount, toRefs } from 'vue';\nimport { InputValue, TdInputProps } from './type';\n\nconst ANIMATION_TIME = 100;\n\nexport default function useInputWidth(\n  props: TdInputProps,\n  inputRef: Ref<HTMLInputElement>,\n  innerValue: Ref<InputValue>,\n) {\n  const { autoWidth, placeholder } = toRefs(props);\n  const inputPreRef = ref<HTMLSpanElement>(null);\n  const observerTimer = ref(null);\n\n  const updateInputWidth = () => {\n    if (!inputPreRef.value || !inputRef.value) return;\n    const { width } = inputPreRef.value.getBoundingClientRect();\n    inputRef.value.style.width = `${width || 0}px`;\n  };\n\n  useResizeObserver(inputRef, () => {\n    if (autoWidth.value) {\n      observerTimer.value = setTimeout(() => {\n        updateInputWidth();\n        clearTimeout(observerTimer.value);\n      }, ANIMATION_TIME);\n    }\n  });\n\n  onBeforeUnmount(() => {\n    clearTimeout(observerTimer.value);\n  });\n\n  const addListeners = () => {\n    watch(\n      [innerValue, placeholder],\n      () => {\n        if (!autoWidth.value) return;\n        nextTick(() => {\n          updateInputWidth();\n        });\n      },\n      { immediate: true },\n    );\n  };\n\n  onMounted(() => {\n    if (autoWidth.value) {\n      addListeners();\n    }\n  });\n\n  return {\n    inputPreRef,\n  };\n}\n"],"names":["ANIMATION_TIME","useInputWidth","props","inputRef","innerValue","_toRefs","toRefs","autoWidth","placeholder","inputPreRef","ref","observerTimer","updateInputWidth","value","_inputPreRef$value$ge","getBoundingClientRect","width","style","concat","useResizeObserver","setTimeout","clearTimeout","onBeforeUnmount","addListeners","watch","nextTick","immediate","onMounted"],"mappings":";;;;;;;;;AAIA,IAAMA,cAAiB,GAAA,GAAA,CAAA;AAEC,SAAAC,aAAAA,CACtBC,KACA,EAAAC,QAAA,EACAC,UACA,EAAA;AACA,EAAA,IAAAC,OAAA,GAAmCC,OAAOJ,KAAK,CAAA;IAAvCK,SAAA,GAAAF,OAAA,CAAAE,SAAA;IAAWC,WAAY,GAAAH,OAAA,CAAZG,WAAY,CAAA;AACzB,EAAA,IAAAC,WAAA,GAAcC,IAAqB,IAAI,CAAA,CAAA;AACvC,EAAA,IAAAC,aAAA,GAAgBD,IAAI,IAAI,CAAA,CAAA;AAE9B,EAAA,IAAME,mBAAmB,SAAnBA,mBAAyB;IAC7B,IAAI,CAACH,WAAA,CAAYI,KAAS,IAAA,CAACV,QAAS,CAAAU,KAAA,EAAO,OAAA;IAC3C,IAAAC,qBAAA,GAAkBL,WAAA,CAAYI,MAAME,qBAAsB,EAAA;MAAlDC,KAAA,GAAAF,qBAAA,CAAAE,KAAA,CAAA;AACRb,IAAAA,QAAA,CAASU,KAAM,CAAAI,KAAA,CAAMD,KAAQ,GAAAE,EAAAA,CAAAA,MAAA,CAAGF,KAAS,IAAA,CAAA,EAAA,IAAA,CAAA,CAAA;GAC3C,CAAA;EAEAG,iBAAA,CAAkBhB,UAAU,YAAM;IAChC,IAAII,UAAUM,KAAO,EAAA;AACLF,MAAAA,aAAA,CAAAE,KAAA,GAAQO,WAAW,YAAM;AACpBR,QAAAA,gBAAA,EAAA,CAAA;AACjBS,QAAAA,YAAA,CAAaV,cAAcE,KAAK,CAAA,CAAA;SAC/Bb,cAAc,CAAA,CAAA;AACnB,KAAA;AACF,GAAC,CAAA,CAAA;AAEDsB,EAAAA,eAAA,CAAgB,YAAM;AACpBD,IAAAA,YAAA,CAAaV,cAAcE,KAAK,CAAA,CAAA;AAClC,GAAC,CAAA,CAAA;AAED,EAAA,IAAMU,eAAe,SAAfA,eAAqB;AACzBC,IAAAA,KAAA,CACE,CAACpB,YAAYI,WAAW,CAAA,EACxB,YAAM;AACJ,MAAA,IAAI,CAACD,SAAU,CAAAM,KAAA,EAAO,OAAA;AACtBY,MAAAA,QAAA,CAAS,YAAM;AACIb,QAAAA,gBAAA,EAAA,CAAA;AACnB,OAAC,CAAA,CAAA;AACH,KAAA,EACA;AAAEc,MAAAA,WAAW,IAAA;AAAK,KACpB,CAAA,CAAA;GACF,CAAA;AAEAC,EAAAA,SAAA,CAAU,YAAM;IACd,IAAIpB,UAAUM,KAAO,EAAA;AACNU,MAAAA,YAAA,EAAA,CAAA;AACf,KAAA;AACF,GAAC,CAAA,CAAA;EAEM,OAAA;AACLd,IAAAA,WAAA,EAAAA,WAAAA;GACF,CAAA;AACF;;;;"}