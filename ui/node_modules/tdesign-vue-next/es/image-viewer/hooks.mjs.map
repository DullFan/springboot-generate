{"version":3,"file":"hooks.mjs","sources":["../../src/image-viewer/hooks.ts"],"sourcesContent":["import { positiveSubtract, positiveAdd } from '../_common/js/input-number/number';\nimport { ref, watch } from 'vue';\nimport { ImageScale } from './type';\n\ninterface InitTransform {\n  translateX: number;\n  translateY: number;\n}\n\nexport function useDrag(initTransform: InitTransform) {\n  const transform = ref(initTransform);\n\n  const mouseDownHandler = (e: MouseEvent) => {\n    const { pageX: startX, pageY: startY } = e;\n    const { translateX, translateY } = transform.value;\n    const mouseMoveHandler = (e: MouseEvent) => {\n      const { pageX, pageY } = e;\n      transform.value = {\n        translateX: translateX + pageX - startX,\n        translateY: translateY + pageY - startY,\n      };\n    };\n    const mouseUpHandler = () => {\n      document.removeEventListener('mousemove', mouseMoveHandler);\n      document.removeEventListener('mouseup', mouseUpHandler);\n    };\n\n    document.addEventListener('mousemove', mouseMoveHandler);\n    document.addEventListener('mouseup', mouseUpHandler);\n  };\n\n  const resetTransform = () => {\n    transform.value = { ...initTransform };\n  };\n\n  return { transform, mouseDownHandler, resetTransform };\n}\n\nexport function useMirror() {\n  const mirror = ref(1);\n  const onMirror = () => {\n    mirror.value *= -1;\n  };\n  const resetMirror = () => {\n    mirror.value = 1;\n  };\n\n  return { mirror, onMirror, resetMirror };\n}\n\nexport function useScale(imageScale: ImageScale = { max: 2, min: 0.5, step: 0.5 }) {\n  const { max, min, step, defaultScale } = imageScale;\n  const scale = ref(defaultScale ?? 1);\n  const onZoomIn = () => {\n    const result = positiveAdd(scale.value, step);\n    setScale(result);\n  };\n  const onZoomOut = () => {\n    const result = positiveSubtract(scale.value, step);\n    setScale(result);\n  };\n  const resetScale = () => {\n    scale.value = defaultScale ?? 1;\n  };\n\n  const setScale = (newScale: number) => {\n    let value = newScale;\n    if (newScale < min) {\n      value = min;\n    }\n    if (newScale > max) {\n      value = max;\n    }\n    scale.value = value;\n  };\n\n  watch(\n    () => imageScale,\n    () => resetScale(),\n  );\n\n  return { scale, onZoomIn, onZoomOut, resetScale };\n}\n\nexport function useRotate() {\n  const rotate = ref(0);\n  const ROTATE_DEG = 90;\n\n  const onRotate = () => {\n    rotate.value += ROTATE_DEG;\n  };\n  const resetRotate = () => {\n    rotate.value = 0;\n  };\n\n  return { rotate, onRotate, resetRotate };\n}\n"],"names":["useDrag","initTransform","transform","ref","mouseDownHandler","e","startX","pageX","startY","pageY","_transform$value","value","translateX","translateY","mouseMoveHandler","mouseUpHandler","document","removeEventListener","addEventListener","resetTransform","_objectSpread","useMirror","mirror","onMirror","resetMirror","useScale","imageScale","max","min","step","defaultScale","scale","onZoomIn","result","positiveAdd","setScale","onZoomOut","positiveSubtract","resetScale","newScale","watch","useRotate","rotate","ROTATE_DEG","onRotate","resetRotate"],"mappings":"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"}